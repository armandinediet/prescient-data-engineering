{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.11.2", "generated_at": "2026-01-29T18:27:46.509092Z", "invocation_id": "b3319d12-ba5f-444b-8b02-61db193fe9c1", "invocation_started_at": "2026-01-29T18:27:44.651658Z", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-29T18:27:46.040825Z", "completed_at": "2026-01-29T18:27:46.052873Z"}, {"name": "execute", "started_at": "2026-01-29T18:27:46.053563Z", "completed_at": "2026-01-29T18:27:46.224603Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.18535113334655762, "adapter_response": {"_message": "SELECT 80", "code": "SELECT", "rows_affected": 80}, "message": "SELECT 80", "failures": null, "unique_id": "model.weather.weather_forecast_unnest", "compiled": true, "compiled_code": "\n\nwith src as (\n  select\n    id as raw_event_id,\n    request_id,\n    run_id,\n    requested_at,\n    status_code,\n    error,\n    request_url,\n    request_params,\n    extra_meta,\n    flatten_payload\n  from \"weather\".\"raw\".\"raw_weather_forecast\"\n  where job_name = 'openweather_forecast'\n    and flatten_payload is not null\n)\n\nselect\n  -- identifiers / lineage\n  raw_event_id,\n  request_id,\n  run_id,\n  requested_at as ingested_at,\n\n  -- optional request metadata\n  status_code,\n  error,\n\n  -- city metadata (stored in extra_meta)\n  (extra_meta->'city'->>'id')::int as city_id,\n  extra_meta->'city'->>'name' as city_name,\n  extra_meta->'city'->>'country' as country,\n  (extra_meta->'city'->'coord'->>'lat')::double precision as lat,\n  (extra_meta->'city'->'coord'->>'lon')::double precision as lon,\n  (extra_meta->'city'->>'timezone')::int as timezone_offset_sec,\n\n  -- forecast fields (flatten_payload dotted keys)\n  (flatten_payload->>'dt')::bigint as forecast_dt_unix,\n  (flatten_payload->>'dt_txt')::timestamp as forecast_dt_txt,\n\n  (flatten_payload->>'main.temp')::double precision as temp,\n  (flatten_payload->>'main.feels_like')::double precision as feels_like,\n  (flatten_payload->>'main.temp_min')::double precision as temp_min,\n  (flatten_payload->>'main.temp_max')::double precision as temp_max,\n  (flatten_payload->>'main.pressure')::int as pressure,\n  (flatten_payload->>'main.humidity')::int as humidity,\n  (flatten_payload->>'clouds.all')::int as clouds_all,\n  (flatten_payload->>'visibility')::int as visibility,\n  (flatten_payload->>'wind.speed')::double precision as wind_speed,\n  (flatten_payload->>'wind.deg')::int as wind_deg,\n  (flatten_payload->>'wind.gust')::double precision as wind_gust,\n  (flatten_payload->>'pop')::double precision as pop,\n  (flatten_payload->>'rain.3h')::double precision as rain_3h,\n  (flatten_payload->>'snow.3h')::double precision as snow_3h,\n  (flatten_payload->>'sys.pod') as pod,\n\n  -- weather is still an array in flatten_payload; take the first element (index 0)\n  ((flatten_payload->'weather'->0)->>'id')::int as weather_id,\n  (flatten_payload->'weather'->0)->>'main' as weather_main,\n  (flatten_payload->'weather'->0)->>'description' as weather_description,\n  (flatten_payload->'weather'->0)->>'icon' as weather_icon\n\nfrom src", "relation_name": "\"weather\".\"staging\".\"weather_forecast_unnest\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-29T18:27:46.231509Z", "completed_at": "2026-01-29T18:27:46.235524Z"}, {"name": "execute", "started_at": "2026-01-29T18:27:46.235982Z", "completed_at": "2026-01-29T18:27:46.300828Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.0711820125579834, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.weather.weather_forecast_dedup", "compiled": true, "compiled_code": "\n\nwith src as (\n\n  select\n    *\n  from \"weather\".\"staging\".\"weather_forecast_unnest\"\n  where city_id is not null\n    and forecast_dt_txt is not null\n\n),\n\ndedup as (\n\n  select\n    *,\n    row_number() over (\n      partition by city_id, forecast_dt_txt\n      order by\n        ingested_at desc,\n        raw_event_id desc\n    ) as _rn\n  from src\n\n)\n\nselect\n  -- lineage\n  raw_event_id,\n  request_id,\n  run_id,\n  ingested_at,\n\n  -- city\n  city_id,\n  city_name,\n  country,\n  lat,\n  lon,\n  timezone_offset_sec,\n\n  -- forecast keys\n  forecast_dt_unix,\n  forecast_dt_txt,\n\n  -- metrics\n  temp,\n  feels_like,\n  temp_min,\n  temp_max,\n  pressure,\n  humidity,\n  clouds_all,\n  visibility,\n  wind_speed,\n  wind_deg,\n  wind_gust,\n  pop,\n  rain_3h,\n  snow_3h,\n  pod,\n\n  -- weather\n  weather_id,\n  weather_main,\n  weather_description,\n  weather_icon\n\nfrom dedup\nwhere _rn = 1", "relation_name": "\"weather\".\"staging\".\"weather_forecast_dedup\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-29T18:27:46.306570Z", "completed_at": "2026-01-29T18:27:46.310487Z"}, {"name": "execute", "started_at": "2026-01-29T18:27:46.310936Z", "completed_at": "2026-01-29T18:27:46.352960Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.04833412170410156, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.weather.weather_forecast_canonical", "compiled": true, "compiled_code": "\n\nselect\n  -- grain: one row per city + forecast timestamp\n  concat(city_id, cast(forecast_dt_txt as text)) as unique_id,\n  --null as unique_id,\n  city_id,\n  city_name,\n  country,\n  lat,\n  lon,\n  timezone_offset_sec,\n\n  forecast_dt_unix,\n  forecast_dt_txt,\n\n  -- core weather metrics\n  temp,\n  feels_like,\n  temp_min,\n  temp_max,\n  pressure,\n  humidity,\n  clouds_all,\n  visibility,\n  wind_speed,\n  wind_deg,\n  wind_gust,\n  pop,\n  rain_3h,\n  snow_3h,\n  pod,\n\n  weather_id,\n  weather_main,\n  weather_description,\n  weather_icon,\n\n  -- lineage / freshness\n  ingested_at\n\nfrom \"weather\".\"staging\".\"weather_forecast_dedup\"", "relation_name": "\"weather\".\"staging\".\"weather_forecast_canonical\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-29T18:27:46.359453Z", "completed_at": "2026-01-29T18:27:46.403024Z"}, {"name": "execute", "started_at": "2026-01-29T18:27:46.403699Z", "completed_at": "2026-01-29T18:27:46.425558Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.06777691841125488, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.weather.weather_forecast_pre_release_tests", "compiled": true, "compiled_code": "\n\n\n\n\n  \n  \n\n    \n\n    \n\n    \n\n    \n    \n    \n\n    \n    \n\n    \n      \n      \n      \n      \n    \n      \n      \n      \n      \n    \n\n    \n\n    select 'pass' as tests_result\n\n  ", "relation_name": "\"weather\".\"staging\".\"weather_forecast_pre_release_tests\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-29T18:27:46.430661Z", "completed_at": "2026-01-29T18:27:46.438224Z"}, {"name": "execute", "started_at": "2026-01-29T18:27:46.438775Z", "completed_at": "2026-01-29T18:27:46.483518Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.05441689491271973, "adapter_response": {"_message": "SELECT 80", "code": "SELECT", "rows_affected": 80}, "message": "SELECT 80", "failures": null, "unique_id": "model.weather.weather_forecast_cardinal", "compiled": true, "compiled_code": "\n  \n\n  \n  \n    \n  \n\n\n\n\nselect\n  -- grain: one row per city + forecast timestamp\n  unique_id,\n  city_id,\n  city_name,\n  country,\n  lat,\n  lon,\n  timezone_offset_sec,\n\n  forecast_dt_unix,\n  forecast_dt_txt,\n\n  -- core weather metrics\n  temp,\n  feels_like,\n  temp_min,\n  temp_max,\n  pressure,\n  humidity,\n  clouds_all,\n  visibility,\n  wind_speed,\n  wind_deg,\n  wind_gust,\n  pop,\n  rain_3h,\n  snow_3h,\n  pod,\n\n  weather_id,\n  weather_main,\n  weather_description,\n  weather_icon,\n\n  -- lineage / freshness\n  ingested_at\n\nfrom \"weather\".\"staging\".\"weather_forecast_canonical\"", "relation_name": "\"weather\".\"mart\".\"weather_forecast_cardinal\"", "batch_results": null}], "elapsed_time": 0.7758901119232178, "args": {"project_dir": "/Users/armandorodrigues/Documents/github/prescient/dbt", "print": true, "require_batched_execution_for_custom_microbatch_strategy": false, "upload_to_artifacts_ingest_api": false, "printer_width": 80, "use_colors_file": true, "require_resource_names_without_spaces": true, "require_all_warnings_handled_by_warn_error": false, "warn_error_options": {"error": [], "warn": [], "silence": []}, "source_freshness_run_project_hooks": true, "skip_nodes_if_on_run_start_fails": false, "state_modified_compare_vars": false, "populate_cache": true, "invocation_command": "dbt run --selector weather_forecast --project-dir /Users/armandorodrigues/Documents/github/prescient/dbt --profiles-dir /Users/armandorodrigues/Documents/github/prescient/dbt --full-refresh", "cache_selected_only": false, "log_format": "default", "static_parser": true, "which": "run", "favor_state": false, "exclude": [], "profiles_dir": "/Users/armandorodrigues/Documents/github/prescient/dbt", "full_refresh": true, "require_ref_searches_node_package_before_root": false, "state_modified_compare_more_unrendered_values": false, "indirect_selection": "eager", "use_fast_test_edges": false, "validate_macro_args": false, "introspect": true, "partial_parse": true, "require_generic_test_arguments_property": true, "vars": {}, "strict_mode": false, "write_json": true, "partial_parse_file_diff": true, "require_unique_project_resource_names": false, "require_yaml_configuration_for_mf_time_spines": false, "selector": "weather_forecast", "empty": false, "macro_debugging": false, "quiet": false, "log_format_file": "debug", "select": [], "show_resource_report": false, "log_file_max_bytes": 10485760, "use_colors": true, "log_level_file": "debug", "log_level": "info", "require_explicit_package_overrides_for_builtin_materializations": true, "send_anonymous_usage_stats": true, "show_all_deprecations": false, "log_path": "/Users/armandorodrigues/Documents/github/prescient/dbt/logs", "version_check": true, "defer": false, "require_nested_cumulative_type_params": false}}